<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Variety Normal Distribution • vnorm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Variety Normal Distribution">
<meta property="og:description" content="Samples, projects, and visualizes variety normal distributions.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">vnorm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="vnorm">vnorm<a class="anchor" aria-label="anchor" href="#vnorm"></a>
</h1></div>
<p><img src="reference/figures/logo.png" align="right" width="180"></p>
<p><a href="https://cran.r-project.org/package=vnorm" class="external-link">CRAN status</a> <a href="https://cran.r-project.org/package=vnorm" class="external-link"><img src="https://img.shields.io/badge/CRAN-not%20released-lightgrey" alt="CRAN status"></a> <a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="repo status"></a> <a href="https://app.codecov.io/gh/sonish13/vnorm" class="external-link"><img src="https://codecov.io/gh/sonish13/vnorm/branch/main/graph/badge.svg" alt="codecov"></a></p>
<p><code>vnorm</code> provides tools for sampling, visualizing, and projecting near real algebraic varieties defined by polynomial equations. It implements the variety normal distribution using <code>mpoly</code> for polynomial representations and Stan-based samplers. In addition to sampling with <code><a href="reference/rvnorm.html">rvnorm()</a></code>, the package includes pseudo-density evaluation via <code><a href="reference/pdvnorm.html">pdvnorm()</a></code>, ggplot2 visualization with <code><a href="reference/geom_variety.html">geom_variety()</a></code>, and projection onto varieties with <code><a href="reference/project-onto-variety.html">project_onto_variety()</a></code>.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of <code>vnorm</code> from GitHub with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"dkahle/mpoly"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"sonish13/vnorm"</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="reference/rvnorm.html">rvnorm()</a></code> uses Stan/HMC as the primary sampling backend, so you should install <code>cmdstanr</code> and CmdStan for normal package use. A rejection sampler interface is also available (<code>rejection = TRUE</code>) and can be useful for quick examples or simple low-dimensional cases.</p>
</div>
<div class="section level2">
<h2 id="quick-start-sample-and-plot-a-variety">Quick Start: Sample and Plot a Variety<a class="anchor" aria-label="anchor" href="#quick-start-sample-and-plot-a-variety"></a>
</h2>
<p>The main workflow is: define a polynomial variety, sample near it with <code><a href="reference/rvnorm.html">rvnorm()</a></code>, and visualize with <code><a href="reference/geom_variety.html">geom_variety()</a></code>.</p>
<p>Stan/HMC (primary path):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mpoly/man/mp.html" class="external-link">mp</a></span><span class="op">(</span><span class="st">"x^2 + y^2 - 1"</span><span class="op">)</span></span>
<span><span class="va">samps1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rvnorm.html">rvnorm</a></span><span class="op">(</span></span>
<span>  <span class="fl">2000</span>,</span>
<span>  poly <span class="op">=</span> <span class="va">p1</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  output <span class="op">=</span> <span class="st">"tibble"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">samps1</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_variety.html">geom_variety</a></span><span class="op">(</span>poly <span class="op">=</span> <span class="va">p1</span>, inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_equal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="72%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="main-functions">Main Functions<a class="anchor" aria-label="anchor" href="#main-functions"></a>
</h2>
<ul>
<li>
<code><a href="reference/rvnorm.html">rvnorm()</a></code> samples from a variety normal distribution near a polynomial variety.</li>
<li>
<code><a href="reference/pdvnorm.html">pdvnorm()</a></code> evaluates the pseudo-density (up to a normalizing constant).</li>
<li>
<code><a href="reference/geom_variety.html">geom_variety()</a></code> plots real 1D varieties in 2D using <code>ggplot2</code>.</li>
<li>
<code><a href="reference/project-onto-variety.html">project_onto_variety()</a></code> projects points onto a variety.</li>
<li>
<code><a href="reference/compile_stan_code.html">compile_stan_code()</a></code> pre-compiles reusable Stan models for repeated sampling with related polynomial forms.</li>
</ul>
<div class="section level3">
<h3 id="rvnorm-the-main-sampling-function">
<code>rvnorm()</code>: the main sampling function<a class="anchor" aria-label="anchor" href="#rvnorm-the-main-sampling-function"></a>
</h3>
<p><code><a href="reference/rvnorm.html">rvnorm()</a></code> is the main entry point for sampling near varieties defined by one polynomial (<code>mpoly</code>) or a system of polynomials (<code>mpolyList</code>). It supports:</p>
<ul>
<li>Stan/HMC sampling (default; best for most serious use)</li>
<li>rejection sampling (<code>rejection = TRUE</code>; good for quick examples and simple cases)</li>
<li>built-in pre-compiled Stan models (<code>pre_compiled = TRUE</code>) for common polynomial structures</li>
<li>user pre-compiled Stan models (<code>user_compiled = TRUE</code>) for repeated sampling of related polynomial forms</li>
</ul>
<p>Common arguments:</p>
<ul>
<li>
<code>poly</code>: the polynomial or polynomial system defining the target variety</li>
<li>
<code>sd</code> / <code>Sigma</code>: controls concentration around the variety</li>
<li>
<code>output</code>: output format (for example <code>"tibble"</code>)</li>
<li>
<code>w</code>: window size for unbounded varieties (and for rejection sampling)</li>
<li>
<code>rejection</code>: use the rejection sampler instead of Stan/HMC</li>
</ul>
<p>The Stan/HMC path is the default and recommended mode for most use. The rejection sampler is available as a lighter-weight alternative for some low dimensional examples.</p>
<p>Default Stan/HMC usage:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mpoly/man/mp.html" class="external-link">mp</a></span><span class="op">(</span><span class="st">"x^2 + y^2 - 1"</span><span class="op">)</span></span>
<span><span class="va">samps2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rvnorm.html">rvnorm</a></span><span class="op">(</span><span class="fl">2000</span>, poly <span class="op">=</span> <span class="va">p2</span>, sd <span class="op">=</span> <span class="fl">0.1</span>, output <span class="op">=</span> <span class="st">"tibble"</span><span class="op">)</span></span></code></pre></div>
<p>Typical default workflow (sample, then visualize), shown above:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mpoly/man/mp.html" class="external-link">mp</a></span><span class="op">(</span><span class="st">"x^2 + y^2 - 1"</span><span class="op">)</span></span>
<span><span class="va">samps2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rvnorm.html">rvnorm</a></span><span class="op">(</span><span class="fl">2000</span>, poly <span class="op">=</span> <span class="va">p2</span>, sd <span class="op">=</span> <span class="fl">0.1</span>, output <span class="op">=</span> <span class="st">"tibble"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">samps2</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0.35</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_variety.html">geom_variety</a></span><span class="op">(</span>poly <span class="op">=</span> <span class="va">p2</span>, inherit.aes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_equal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Additional common <code><a href="reference/rvnorm.html">rvnorm()</a></code> usage patterns:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use a packaged pre-compiled Stan model when available (small degree/variable cases)</span></span>
<span><span class="fu"><a href="reference/rvnorm.html">rvnorm</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fu"><a href="https://rdrr.io/pkg/mpoly/man/mp.html" class="external-link">mp</a></span><span class="op">(</span><span class="st">"x^2 + y^2 + z^2 - 1"</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">0.1</span>, pre_compiled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Unbounded varieties typically need a window parameter w</span></span>
<span><span class="fu"><a href="reference/rvnorm.html">rvnorm</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fu"><a href="https://rdrr.io/pkg/mpoly/man/mp.html" class="external-link">mp</a></span><span class="op">(</span><span class="st">"x y - 1"</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">0.1</span>, w <span class="op">=</span> <span class="fl">2</span>, output <span class="op">=</span> <span class="st">"tibble"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Multi-polynomial systems (underdetermined / overdetermined are both supported)</span></span>
<span><span class="fu"><a href="reference/rvnorm.html">rvnorm</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fu"><a href="https://rdrr.io/pkg/mpoly/man/mp.html" class="external-link">mp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x^2 + y^2 + z^2 - 1"</span>, <span class="st">"z"</span><span class="op">)</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">0.1</span>, output <span class="op">=</span> <span class="st">"tibble"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use Sigma for anisotropic concentration (single polynomial)</span></span>
<span><span class="fu"><a href="reference/rvnorm.html">rvnorm</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fu"><a href="https://rdrr.io/pkg/mpoly/man/mp.html" class="external-link">mp</a></span><span class="op">(</span><span class="st">"x^2 + y^2 - 1"</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.10</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, output <span class="op">=</span> <span class="st">"tibble"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use Sigma with polynomial systems as well</span></span>
<span><span class="fu"><a href="reference/rvnorm.html">rvnorm</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fu"><a href="https://rdrr.io/pkg/mpoly/man/mp.html" class="external-link">mp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x^2 + y^2 - 1"</span>, <span class="st">"x y - 0.25"</span><span class="op">)</span><span class="op">)</span>, Sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.08</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Rejection sampler usage (alternative path; currently the wrapper supports scalar <code>sd</code>):</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mpoly/man/mp.html" class="external-link">mp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x^2 + y^2 - 1"</span>, <span class="st">"x y - 0.25"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">samps3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rvnorm.html">rvnorm</a></span><span class="op">(</span></span>
<span>  <span class="fl">2000</span>,</span>
<span>  poly <span class="op">=</span> <span class="va">p3</span>,</span>
<span>  sd <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  rejection <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  w <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  output <span class="op">=</span> <span class="st">"tibble"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">samps3</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_variety.html">geom_variety</a></span><span class="op">(</span>poly <span class="op">=</span> <span class="va">p3</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, inherit.aes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_equal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pdvnorm-pseudo-density-evaluation">
<code>pdvnorm()</code>: pseudo-density evaluation<a class="anchor" aria-label="anchor" href="#pdvnorm-pseudo-density-evaluation"></a>
</h3>
<p><code><a href="reference/pdvnorm.html">pdvnorm()</a></code> can be used with single polynomials and polynomial systems, and supports scalar, vector, or matrix <code>sigma</code> inputs depending on the setting.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mpoly/man/mp.html" class="external-link">mp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x^2 + y^2 - 1"</span>, <span class="st">"x y - 0.25"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/pdvnorm.html">pdvnorm</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">p4</span>, sigma <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1560083</span></span>
<span><span class="fu"><a href="reference/pdvnorm.html">pdvnorm</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">p4</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, homo <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.1085086</span></span>
<span><span class="fu"><a href="reference/pdvnorm.html">pdvnorm</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">p4</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.07810636</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="geom_variety-ggplot2-compatible-variety-plots">
<code>geom_variety()</code>: ggplot2-compatible variety plots<a class="anchor" aria-label="anchor" href="#geom_variety-ggplot2-compatible-variety-plots"></a>
</h3>
<p><code><a href="reference/geom_variety.html">geom_variety()</a></code> supports both single-polynomial (<code>mpoly</code>) and multi-polynomial (<code>mpolyList</code>) inputs and works with standard ggplot2 themes/scales.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mpoly/man/mp.html" class="external-link">mp</a></span><span class="op">(</span><span class="st">"(x^2 + y^2)^2 - 2 (x^2 - y^2)"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_variety.html">geom_variety</a></span><span class="op">(</span>poly <span class="op">=</span> <span class="va">p5</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_equal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="72%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mpoly/man/mp.html" class="external-link">mp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x^2 + y^2 - 1"</span>, <span class="st">"x y - 0.25"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_variety.html">geom_variety</a></span><span class="op">(</span></span>
<span>    poly <span class="op">=</span> <span class="va">p6</span>,</span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    vary_colour <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_equal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_colour_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"firebrick"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png" width="72%" style="display: block; margin: auto;"></p>
<p>If a squared polynomial (for example, <code>p^2</code>) produces no contour at <code>shift = 0</code>, <code><a href="reference/geom_variety.html">geom_variety()</a></code> prints a suggested negative <code>shift</code>. Using that <code>shift</code> can help recover the plotted zero set in no-sign-change cases.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mpoly/man/mp.html" class="external-link">mp</a></span><span class="op">(</span><span class="st">"y^2 - x^2"</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_variety.html">geom_variety</a></span><span class="op">(</span>poly <span class="op">=</span> <span class="va">p7</span><span class="op">^</span><span class="fl">2</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_equal</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; All values are positive on the plotting grid; try shift = -0.000959513.</span></span>
<span><span class="co">#&gt; Zero contours were generated</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mpoly/man/mp.html" class="external-link">mp</a></span><span class="op">(</span><span class="st">"y^2 - x^2"</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="reference/geom_variety.html">geom_variety</a></span><span class="op">(</span></span>
<span>    poly <span class="op">=</span> <span class="va">p7</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>    shift <span class="op">=</span> <span class="op">-</span><span class="fl">0.000959513</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_equal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="62%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="project_onto_variety-projection-with-visualization">
<code>project_onto_variety()</code>: projection with visualization<a class="anchor" aria-label="anchor" href="#project_onto_variety-projection-with-visualization"></a>
</h3>
<p>The projection functions are useful for snapping points back to a variety and for inspecting projection behavior visually.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mpoly/man/mp.html" class="external-link">mp</a></span><span class="op">(</span><span class="st">"x^2 + y^2 - 0.25"</span><span class="op">)</span></span>
<span><span class="va">x0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.3</span>, <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">x0_proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/project-onto-variety.html">project_onto_variety</a></span><span class="op">(</span><span class="va">x0</span>, <span class="va">p8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.4110961 0.2846050</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-14-1.png" width="62%" style="display: block; margin: auto;"></p>
<p>The red point is the starting value and the black point is its projection onto the variety. The grey segment shows the displacement from the starting point to the projected point.</p>
<p>Adaptive time stepping is used by default. The comparison below illustrates the homotopy projection path from the same starting point using fixed step sizes versus adaptive step sizes (similar to the paper figure). The open circles mark successive iterates along the path.</p>
<p><img src="reference/figures/README-unnamed-chunk-15-1.png" width="92%" style="display: block; margin: auto;"></p>
<p>In each panel, the black curve is the target variety (an ellipse segment), the connected black path is the homotopy projection path from the same starting point, and the open circles show the successive iterates. The adaptive method is the default because it typically reaches the variety in fewer steps while maintaining the error tolerance.</p>
</div>
</div>
<div class="section level2">
<h2 id="performance-notes">Performance Notes<a class="anchor" aria-label="anchor" href="#performance-notes"></a>
</h2>
<p><code>vnorm</code> includes pre-compiled Stan models for common polynomial structures (up to three variables and total degree at most three). For repeated work with a custom polynomial form, use <code><a href="reference/compile_stan_code.html">compile_stan_code()</a></code> once and then call <code><a href="reference/rvnorm.html">rvnorm()</a></code> with <code>user_compiled = TRUE</code> on related polynomials with different coefficients.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_template</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mpoly/man/mp.html" class="external-link">mp</a></span><span class="op">(</span><span class="st">"x^4 + y^4 - 1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/compile_stan_code.html">compile_stan_code</a></span><span class="op">(</span>poly <span class="op">=</span> <span class="va">p_template</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mpoly/man/mp.html" class="external-link">mp</a></span><span class="op">(</span><span class="st">"2 x^4 + 3 y^4 - 1"</span><span class="op">)</span></span>
<span><span class="va">samps_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rvnorm.html">rvnorm</a></span><span class="op">(</span><span class="fl">1000</span>, poly <span class="op">=</span> <span class="va">p_new</span>, sd <span class="op">=</span> <span class="fl">0.1</span>, user_compiled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="learn-more">Learn More<a class="anchor" aria-label="anchor" href="#learn-more"></a>
</h2>
<p>The accompanying paper describes the variety normal distribution, projection and sampling methods, and package applications in more detail. The README focuses on the main user-facing workflow: sample, visualize, evaluate, and project.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>Kahle, David and Hauenstein, Jonathan D. (2024). <em>Stochastic Exploration of Real Varieties via Variety Distributions</em>. <a href="https://arxiv.org/abs/2410.16071" class="external-link">arXiv:2410.16071</a>
</li>
<li>Griffin, Zachary A. and Hauenstein, Jonathan D. (2015). <em>Real solutions to systems of polynomial equations and parameter continuation</em>. <em>Advances in Geometry</em>, 15(2), 173–187. <a href="https://doi.org/10.1515/advgeom-2015-0004" class="external-link">doi:10.1515/advgeom-2015-0004</a>
</li>
<li>Schenck, Henry (2015). <em>Book Review: Numerically solving polynomial systems with Bertini</em>. <em>Bulletin of the American Mathematical Society</em>, 53(1), 179–186. <a href="https://doi.org/10.1090/bull/1520" class="external-link">doi:10.1090/bull/1520</a>
</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing vnorm</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Sonish Lamsal <br><small class="roles"> Author </small>   </li>
<li>David Kahle <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Sonish Lamsal, David Kahle.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
